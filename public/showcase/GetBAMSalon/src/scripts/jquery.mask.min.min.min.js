(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(window.jQuery||window.Zepto)}}(function(a){var c=function(l,g,j){l=a(l);var f=this,i=l.val(),k;g=typeof g==="function"?g(l.val(),undefined,l,j):g;var h={invalid:[],getCaret:function(){try{var p,m=0,o=l.get(0),n=document.selection,r=o.selectionStart;if(n&&navigator.appVersion.indexOf("MSIE 10")===-1){p=n.createRange();p.moveStart("character",l.is("input")?-l.val().length:-l.text().length);m=p.text.length}else{if(r||r==="0"){m=r}}return m}catch(q){}},setCaret:function(m){try{if(l.is(":focus")){var n,o=l.get(0);if(o.setSelectionRange){o.setSelectionRange(m,m)}else{if(o.createTextRange){n=o.createTextRange();n.collapse(true);n.moveEnd("character",m);n.moveStart("character",m);n.select()}}}}catch(p){}},events:function(){l.on("keyup.mask",h.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){l.keydown().keyup()},100)}).on("change.mask",function(){l.data("changed",true)}).on("blur.mask",function(){if(i!==l.val()&&!l.data("changed")){l.trigger("change")}l.data("changed",false)}).on("keydown.mask, blur.mask",function(){i=l.val()}).on("focus.mask",function(m){if(j.selectOnFocus===true){a(m.target).select()}}).on("focusout.mask",function(){if(j.clearIfNotMatch&&!k.test(h.val())){h.val("")}})},getRegexMask:function(){var u=[],o,s,t,q,p,n;for(var m=0;m<g.length;m++){o=f.translation[g.charAt(m)];if(o){s=o.pattern.toString().replace(/.{1}$|^.{1}/g,"");t=o.optional;q=o.recursive;if(q){u.push(g.charAt(m));p={digit:g.charAt(m),pattern:s}}else{u.push(!t&&!q?s:(s+"?"))}}else{u.push(g.charAt(m).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))}}n=u.join("");if(p){n=n.replace(new RegExp("("+p.digit+"(.*"+p.digit+")?)"),"($1)?").replace(new RegExp(p.digit,"g"),p.pattern)}return new RegExp(n)},destroyEvents:function(){l.off(["keydown","keyup","paste","drop","blur","focusout",""].join(".mask "))},val:function(n){var o=l.is("input"),m=o?"val":"text",p;if(arguments.length>0){if(l[m]()!==n){l[m](n)}p=l}else{p=l[m]()}return p},getMCharsBeforeCount:function(o,n){for(var q=0,p=0,m=g.length;p<m&&p<o;p++){if(!f.translation[g.charAt(p)]){o=n?o+1:o;q++}}return q},caretPos:function(m,n,o,q){var p=f.translation[g.charAt(Math.min(m-1,g.length-1))];return !p?h.caretPos(m+1,n,o,q):Math.min(m+o-n-q,o)},behaviour:function(o){o=o||window.event;h.invalid=[];var n=o.keyCode||o.which;if(a.inArray(n,f.byPassKeys)===-1){var u=h.getCaret(),s=h.val(),p=s.length,t=u<p,r=h.getMasked(),q=r.length,m=h.getMCharsBeforeCount(q-1)-h.getMCharsBeforeCount(p-1);h.val(r);if(t&&!(n===65&&o.ctrlKey)){if(!(n===8||n===46)){u=h.caretPos(u,p,q,m)}h.setCaret(u)}return h.callbacks(o)}},getMasked:function(x){var m=[],A=h.val(),p=0,t=g.length,z=0,C=A.length,s=1,r="push",o=-1,n,B;if(j.reverse){r="unshift";s=-1;n=0;p=t-1;z=C-1;B=function(){return p>-1&&z>-1}}else{n=t-1;B=function(){return p<t&&z<C}}while(B()){var q=g.charAt(p),y=A.charAt(z),w=f.translation[q];if(w){if(y.match(w.pattern)){m[r](y);if(w.recursive){if(o===-1){o=p}else{if(p===n){p=o-s}}if(n===o){p-=s}}p+=s}else{if(w.optional){p+=s;z-=s}else{if(w.fallback){m[r](w.fallback);p+=s;z-=s}else{h.invalid.push({p:z,v:y,e:w.pattern})}}}z+=s}else{if(!x){m[r](q)}if(y===q){z+=s}p+=s}}var u=g.charAt(n);if(t===C+1&&!f.translation[u]){m.push(u)}return m.join("")},callbacks:function(o){var q=h.val(),p=q!==i,n=[q,o,l,j],m=function(s,t,r){if(typeof j[s]==="function"&&t){j[s].apply(this,r)}};m("onChange",p===true,n);m("onKeyPress",p===true,n);m("onComplete",q.length===g.length,n);m("onInvalid",h.invalid.length>0,[q,o,l,h.invalid,j])}};f.mask=g;f.options=j;f.remove=function(){var m=h.getCaret();h.destroyEvents();h.val(f.getCleanVal());h.setCaret(m-h.getMCharsBeforeCount(m));return l};f.getCleanVal=function(){return h.getMasked(true)};f.init=function(n){n=n||false;j=j||{};f.byPassKeys=a.jMaskGlobals.byPassKeys;f.translation=a.jMaskGlobals.translation;f.translation=a.extend({},f.translation,j.translation);f=a.extend(true,{},f,j);k=h.getRegexMask();if(n===false){if(j.placeholder){l.attr("placeholder",j.placeholder)}l.attr("autocomplete","off");h.destroyEvents();h.events();var m=h.getCaret();h.val(h.getMasked());h.setCaret(m+h.getMCharsBeforeCount(m,true))}else{h.events();h.val(h.getMasked())}};f.init(!l.is("input"))};a.maskWatchers={};var b=function(){var i=a(this),f={},g="data-mask-",h=i.attr("data-mask");if(i.attr(g+"reverse")){f.reverse=true}if(i.attr(g+"clearifnotmatch")){f.clearIfNotMatch=true}if(i.attr(g+"selectonfocus")==="true"){f.selectOnFocus=true}if(d(i,h,f)){return i.data("mask",new c(this,h,f))}},d=function(l,k,g){g=g||{};var f=a(l).data("mask"),h=JSON.stringify,i=a(l).val()||a(l).text();try{if(typeof k==="function"){k=k(i)}return typeof f!=="object"||h(f.options)!==h(g)||f.mask!==k}catch(j){}};a.fn.mask=function(i,f){f=f||{};var h=this.selector,g=a.jMaskGlobals,k=a.jMaskGlobals.watchInterval,j=function(){if(d(this,i,f)){return a(this).data("mask",new c(this,i,f))}};a(this).each(j);if(h&&h!==""&&g.watchInputs){clearInterval(a.maskWatchers[h]);a.maskWatchers[h]=setInterval(function(){a(document).find(h).each(j)},k)}return this};a.fn.unmask=function(){clearInterval(a.maskWatchers[this.selector]);delete a.maskWatchers[this.selector];return this.each(function(){var f=a(this).data("mask");if(f){f.remove().removeData("mask")}})};a.fn.cleanVal=function(){return this.data("mask").getCleanVal()};a.applyDataMask=function(){a(document).find(a.jMaskGlobals.maskElements).filter(e.dataMaskAttr).each(b)};var e={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:true,watchInterval:300,watchInputs:true,watchDataMask:false,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{"0":{pattern:/\d/},"9":{pattern:/\d/,optional:true},"#":{pattern:/\d/,recursive:true},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}}};a.jMaskGlobals=a.jMaskGlobals||{};e=a.jMaskGlobals=a.extend(true,{},e,a.jMaskGlobals);if(e.dataMask){a.applyDataMask()}setInterval(function(){if(a.jMaskGlobals.watchDataMask){a.applyDataMask()}},e.watchInterval)}));