(function(b){if(typeof define==="function"&&define.amd){define(["jquery"],b)}else{b(window.jQuery||window.Zepto)}}(function(j){var h=function(c,m,d){c=j(c);var b=this,e=c.val(),n;m=typeof m==="function"?m(c.val(),undefined,c,d):m;var a={invalid:[],getCaret:function(){try{var u,l=0,v=c.get(0),k=document.selection,s=v.selectionStart;if(k&&navigator.appVersion.indexOf("MSIE 10")===-1){u=k.createRange();u.moveStart("character",c.is("input")?-c.val().length:-c.text().length);l=u.text.length}else{if(s||s==="0"){l=s}}return l}catch(t){}},setCaret:function(l){try{if(c.is(":focus")){var k,r=c.get(0);if(r.setSelectionRange){r.setSelectionRange(l,l)}else{if(r.createTextRange){k=r.createTextRange();k.collapse(true);k.moveEnd("character",l);k.moveStart("character",l);k.select()}}}}catch(q){}},events:function(){c.on("keyup.mask",a.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){c.keydown().keyup()},100)}).on("change.mask",function(){c.data("changed",true)}).on("blur.mask",function(){if(e!==c.val()&&!c.data("changed")){c.trigger("change")}c.data("changed",false)}).on("keydown.mask, blur.mask",function(){e=c.val()}).on("focus.mask",function(k){if(d.selectOnFocus===true){j(k.target).select()}}).on("focusout.mask",function(){if(d.clearIfNotMatch&&!n.test(a.val())){a.val("")}})},getRegexMask:function(){var y=[],l,r,z,k,v,w;for(var x=0;x<m.length;x++){l=b.translation[m.charAt(x)];if(l){r=l.pattern.toString().replace(/.{1}$|^.{1}/g,"");z=l.optional;k=l.recursive;if(k){y.push(m.charAt(x));v={digit:m.charAt(x),pattern:r}}else{y.push(!z&&!k?r:(r+"?"))}}else{y.push(m.charAt(x).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))}}w=y.join("");if(v){w=w.replace(new RegExp("("+v.digit+"(.*"+v.digit+")?)"),"($1)?").replace(new RegExp(v.digit,"g"),v.pattern)}return new RegExp(w)},destroyEvents:function(){c.off(["keydown","keyup","paste","drop","blur","focusout",""].join(".mask "))},val:function(k){var r=c.is("input"),l=r?"val":"text",q;if(arguments.length>0){if(c[l]()!==k){c[l](k)}q=c}else{q=c[l]()}return q},getMCharsBeforeCount:function(t,k){for(var r=0,s=0,l=m.length;s<l&&s<t;s++){if(!b.translation[m.charAt(s)]){t=k?t+1:t;r++}}return r},caretPos:function(l,k,t,r){var s=b.translation[m.charAt(Math.min(l-1,m.length-1))];return !s?a.caretPos(l+1,k,t,r):Math.min(l+t-k-r,t)},behaviour:function(l){l=l||window.event;a.invalid=[];var A=l.keyCode||l.which;if(j.inArray(A,b.byPassKeys)===-1){var v=a.getCaret(),x=a.val(),k=x.length,w=v<k,y=a.getMasked(),z=y.length,B=a.getMCharsBeforeCount(z-1)-a.getMCharsBeforeCount(k-1);a.val(y);if(w&&!(A===65&&l.ctrlKey)){if(!(A===8||A===46)){v=a.caretPos(v,k,z,B)}a.setCaret(v)}return a.callbacks(l)}},getMasked:function(I){var l=[],G=a.val(),P=0,L=m.length,v=0,E=G.length,M=1,N="push",Q=-1,k,F;if(d.reverse){N="unshift";M=-1;k=0;P=L-1;v=E-1;F=function(){return P>-1&&v>-1}}else{k=L-1;F=function(){return P<L&&v<E}}while(F()){var O=m.charAt(P),H=G.charAt(v),J=b.translation[O];if(J){if(H.match(J.pattern)){l[N](H);if(J.recursive){if(Q===-1){Q=P}else{if(P===k){P=Q-M}}if(k===Q){P-=M}}P+=M}else{if(J.optional){P+=M;v-=M}else{if(J.fallback){l[N](J.fallback);P+=M;v-=M}else{a.invalid.push({p:v,v:H,e:J.pattern})}}}v+=M}else{if(!I){l[N](O)}if(H===O){v+=M}P+=M}}var K=m.charAt(k);if(L===E+1&&!b.translation[K]){l.push(K)}return l.join("")},callbacks:function(t){var r=a.val(),s=r!==e,k=[r,t,c,d],l=function(p,o,q){if(typeof d[p]==="function"&&o){d[p].apply(this,q)}};l("onChange",s===true,k);l("onKeyPress",s===true,k);l("onComplete",r.length===m.length,k);l("onInvalid",a.invalid.length>0,[r,t,c,a.invalid,d])}};b.mask=m;b.options=d;b.remove=function(){var k=a.getCaret();a.destroyEvents();a.val(b.getCleanVal());a.setCaret(k-a.getMCharsBeforeCount(k));return c};b.getCleanVal=function(){return a.getMasked(true)};b.init=function(k){k=k||false;d=d||{};b.byPassKeys=j.jMaskGlobals.byPassKeys;b.translation=j.jMaskGlobals.translation;b.translation=j.extend({},b.translation,d.translation);b=j.extend(true,{},b,d);n=a.getRegexMask();if(k===false){if(d.placeholder){c.attr("placeholder",d.placeholder)}c.attr("autocomplete","off");a.destroyEvents();a.events();var l=a.getCaret();a.val(a.getMasked());a.setCaret(l+a.getMCharsBeforeCount(l,true))}else{a.events();a.val(a.getMasked())}};b.init(!c.is("input"))};j.maskWatchers={};var i=function(){var c=j(this),b={},a="data-mask-",d=c.attr("data-mask");if(c.attr(a+"reverse")){b.reverse=true}if(c.attr(a+"clearifnotmatch")){b.clearIfNotMatch=true}if(c.attr(a+"selectonfocus")==="true"){b.selectOnFocus=true}if(g(c,d,b)){return c.data("mask",new h(this,d,b))}},g=function(c,n,m){m=m||{};var b=j(c).data("mask"),a=JSON.stringify,e=j(c).val()||j(c).text();try{if(typeof n==="function"){n=n(e)}return typeof b!=="object"||a(b.options)!==a(m)||b.mask!==n}catch(d){}};j.fn.mask=function(e,b){b=b||{};var l=this.selector,a=j.jMaskGlobals,c=j.jMaskGlobals.watchInterval,d=function(){if(g(this,e,b)){return j(this).data("mask",new h(this,e,b))}};j(this).each(d);if(l&&l!==""&&a.watchInputs){clearInterval(j.maskWatchers[l]);j.maskWatchers[l]=setInterval(function(){j(document).find(l).each(d)},c)}return this};j.fn.unmask=function(){clearInterval(j.maskWatchers[this.selector]);delete j.maskWatchers[this.selector];return this.each(function(){var a=j(this).data("mask");if(a){a.remove().removeData("mask")}})};j.fn.cleanVal=function(){return this.data("mask").getCleanVal()};j.applyDataMask=function(){j(document).find(j.jMaskGlobals.maskElements).filter(f.dataMaskAttr).each(i)};var f={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:true,watchInterval:300,watchInputs:true,watchDataMask:false,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{"0":{pattern:/\d/},"9":{pattern:/\d/,optional:true},"#":{pattern:/\d/,recursive:true},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}}};j.jMaskGlobals=j.jMaskGlobals||{};f=j.jMaskGlobals=j.extend(true,{},f,j.jMaskGlobals);if(f.dataMask){j.applyDataMask()}setInterval(function(){if(j.jMaskGlobals.watchDataMask){j.applyDataMask()}},f.watchInterval)}));